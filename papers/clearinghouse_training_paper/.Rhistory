baseline_dealers$index_overall_bag_baseC <- index_overall_bag_base$index
results_dealer_sec_bag <- c("mid_visible_packdate","mid_shelflife_Caro","mid_lot","index_overall_bag_midC","mid_visible_expdate")
results_dealer_sec_bag_base <- c("visible_packdate","shelflife_Caro","lot","index_overall_bag_baseC","visible_expdate")
baseline_dealers[results_dealer_sec_bag_base] <- lapply(baseline_dealers[results_dealer_sec_bag_base],function(x)x - mean(x,na.rm = T))
for (i in 1:length(results_dealer_sec_bag)){
ols <- lm(as.formula(paste(paste(results_dealer_sec_bag[i],"training_demeaned*clearing*farmer_demeaned",sep="~"),results_dealer_sec_bag_base[i],sep="+")),data=baseline_dealers)
#ols <- lm(as.formula(paste(results_dealer_sec_bag[i],"training_demeaned*clearing*farmer_demeaned",sep="~")),data=baseline_dealers)
vcov_cluster <- vcovCR(ols,cluster=baseline_dealers$catchID,type="CR0")
df_ols_D_sec_bag_het3[1,2,i] <- coef_test(ols, vcov_cluster)$beta[3]
df_ols_D_sec_bag_het3[2,2,i] <- coef_test(ols, vcov_cluster)$SE[3]
df_ols_D_sec_bag_het3[3,2,i] <- coef_test(ols, vcov_cluster)$p_Satt[3]}
###
#4#
###
baseline_dealers$farmer_control[baseline_dealers$farmer==0] <- TRUE
baseline_dealers$farmer_control[baseline_dealers$farmer==1] <- FALSE
#5.
index_overall_bag_mid <- icwIndex(xmat=variables_overall_bag_mid,sgroup = baseline_dealers$farmer_control,revcols = c(2))
baseline_dealers$index_overall_bag_midF <- index_overall_bag_mid$index
index_overall_bag_base <- icwIndex(xmat=variables_overall_bag_base,sgroup = baseline_dealers$farmer_control,revcols = c(2))
baseline_dealers$index_overall_bag_baseF <- index_overall_bag_base$index
results_dealer_sec_bag <- c("mid_visible_packdate","mid_shelflife_Caro","mid_lot","index_overall_bag_midF","mid_visible_expdate")
results_dealer_sec_bag_base <- c("visible_packdate","shelflife_Caro","lot","index_overall_bag_baseF","visible_expdate")
baseline_dealers[results_dealer_sec_bag_base] <- lapply(baseline_dealers[results_dealer_sec_bag_base],function(x)x - mean(x,na.rm = T))
for (i in 1:length(results_dealer_sec_bag)){
ols <- lm(as.formula(paste(paste(results_dealer_sec_bag[i],"training_demeaned*clearing_demeaned*farmer",sep="~"),results_dealer_sec_bag_base[i],sep="+")),data=baseline_dealers)
#ols <- lm(as.formula(paste(results_dealer_sec_bag[i],"training_demeaned*clearing_demeaned*farmer",sep="~")),data=baseline_dealers)
vcov_cluster <- vcovCR(ols,cluster=baseline_dealers$catchID,type="CR0")
#farmer video treatment at village/shop level so no clustering needed
df_ols_D_sec_bag_het3[1,3,i] <- summary(ols)$coefficients[4,1]
df_ols_D_sec_bag_het3[2,3,i] <- summary(ols)$coefficients[4,2]
df_ols_D_sec_bag_het3[3,3,i] <- summary(ols)$coefficients[4,4]}
#Aker, Boumnijel, McClelland, Tierney (2012)
df_dealer_sec_bagT <- data.frame(baseline_dealers$mid_visible_packdate,baseline_dealers$mid_shelflife_Caro,baseline_dealers$mid_lot)
df_dealer_sec_bagC <- df_dealer_sec_bagT
df_dealer_sec_bagF <- df_dealer_sec_bagT
#no overall index
df_ols_D_sec_bag_het3_J <- array(NA,dim=c(3,3,11))
results_dealer_sec_bag_J <- c("mid_visible_packdate","mid_shelflife_Caro","mid_lot")
#no overall index
for (i in 1:length(results_dealer_sec_bag_J)){
df_ols_D_sec_bag_het3_J[3,1,i] <- adjust_p(df_ols_D_sec_bag_het3[3,1,i],df_dealer_sec_bagT,i)
df_ols_D_sec_bag_het3_J[3,2,i] <- adjust_p(df_ols_D_sec_bag_het3[3,2,i],df_dealer_sec_bagC,i)
df_ols_D_sec_bag_het3_J[3,3,i] <- adjust_p(df_ols_D_sec_bag_het3[3,3,i],df_dealer_sec_bagF,i)}
baseline_dealers=baseline_dealers_save
################################################################################################################################################################################
##### 2 ANALYSIS: Agro-input dealer - Primary and secondary: outcomes without baseline######################################################################################################
################################################################################################################################################################################
#1. Index of dealer's motivation and satisfaction
#Do you see yourself working as an agro-input dealer 3 years from now? (q9a): yes=good
baseline_dealers$mid_maize.owner.agree.q9_a <- baseline_dealers$owner.agree.client.q9a #x
baseline_dealers$mid_maize.owner.agree.q9_a<-ifelse(baseline_dealers$mid_maize.owner.agree.q9_a=="Yes",1,0) #x
# #Do you think your job makes a positive difference in other's life? (q9b): yes=good
# baseline_dealers$mid_maize.owner.agree.q9.b <- baseline_dealers$owner.agree.client.q9b #x
# baseline_dealers$mid_maize.owner.agree.q9.b<-ifelse(baseline_dealers$mid_maize.owner.agree.q9.b=="Yes",1,0) #x
#
# table(baseline_dealers$mid_maize.owner.agree.q9.b)
# 0   1
# 4 302
#On a scale of 1 to 5, how likely are you to recommend working as an agro-input dealer to friends or family? (q9c) more=better
baseline_dealers$mid_maize.owner.agree.q9_c <- baseline_dealers$owner.agree.client.q9c #x
#On a scale of 1 to 5, how happy do you feel when you come to work in the morning? (q9d) more=better
baseline_dealers$mid_maize.owner.agree.q9_d <- baseline_dealers$owner.agree.client.q9d #x
variables_motivation_mid <- cbind(baseline_dealers$mid_maize.owner.agree.q9_a,baseline_dealers$mid_maize.owner.agree.q9.b
,baseline_dealers$mid_maize.owner.agree.q9_c,baseline_dealers$mid_maize.owner.agree.q9_d) #x
index_motivation_mid <- icwIndex(xmat=variables_motivation_mid) #x
baseline_dealers$index_motivation_mid <- index_motivation_mid$index #x
#2. Index of shop's maize seed ratings by farmers
#NOT IN MIDLINE
nrowD <- nrow(baseline_dealers)
baseline_dealers$mid_general=sample(na.omit(baseline_dealers$general),nrowD,replace = T)
baseline_dealers$mid_yield=sample(na.omit(baseline_dealers$yield),nrowD,replace = T)
baseline_dealers$mid_drought_resistent=sample(na.omit(baseline_dealers$drought_resistent),nrowD,replace = T)
baseline_dealers$mid_disease_resistent=sample(na.omit(baseline_dealers$disease_resistent),nrowD,replace = T)
baseline_dealers$mid_early_maturing=sample(na.omit(baseline_dealers$early_maturing),nrowD,replace = T)
baseline_dealers$mid_germination=sample(na.omit(baseline_dealers$germination),nrowD,replace = T)
variables_ratings_mid <- cbind(baseline_dealers$mid_general,baseline_dealers$mid_yield,baseline_dealers$mid_drought_resistent
,baseline_dealers$mid_disease_resistent,baseline_dealers$mid_early_maturing,baseline_dealers$mid_germination)
#2.
index_ratings_mid <- icwIndex(xmat=variables_ratings_mid)
baseline_dealers$index_ratings_mid <- index_ratings_mid$index
#3. new index_overall_prim_dealer_mid incl. ratings
variables_overall_prim_dealer_mid <- cbind(baseline_dealers$mid_quantitysold,baseline_dealers$mid_revenue
,baseline_dealers$mid_maize.owner.agree.q7
,baseline_dealers$index_practices_cap_mid,baseline_dealers$index_practices_lab_mid
,baseline_dealers$index_efforts_mid) #x
#                                           ,baseline_dealers$index_ratings_mid) #to do after endline
# no ,baseline_dealers$mid_reading bc nobs
index_overall_prim_dealer_mid <- icwIndex(xmat=variables_overall_prim_dealer_mid) #x
baseline_dealers$index_overall_prim_dealer_mid <- index_overall_prim_dealer_mid$index #x
################################################################################################################################################################################
###
#1#
###
results_dealer_sec_nobase <- c("index_motivation_mid","index_ratings_mid"
,"index_overall_prim_dealer_mid","index_overallsec_mid"
,"index_overall_off_mid")
df_means_D_sec_nobase <- array(NA,dim=c(3,10))
for (i in 1:length(results_dealer_sec_nobase)){
df_means_D_sec_nobase[1,i] <- sum(baseline_dealers[results_dealer_sec_nobase[i]], na.rm=T)/(nrow(baseline_dealers)-sum(is.na(baseline_dealers[results_dealer_sec_nobase[i]])))
df_means_D_sec_nobase[2,i] <- sqrt(var(baseline_dealers[results_dealer_sec_nobase[i]], na.rm=T))
df_means_D_sec_nobase[3,i] <- nrow(baseline_dealers)-sum(is.na(baseline_dealers[results_dealer_sec_nobase[i]]))}
###
#2#
###
df_ols_D_sec_nobase <- array(NA,dim=c(3,3,10))
baseline_dealers$training_control[baseline_dealers$training==0] <- TRUE
baseline_dealers$training_control[baseline_dealers$training==1] <- FALSE
#1.
index_motivation_mid <- icwIndex(xmat=variables_motivation_mid,sgroup = baseline_dealers$training_control)
baseline_dealers$index_motivation_midT <- index_motivation_mid$index
#2.
index_ratings_mid <- icwIndex(xmat=variables_ratings_mid,sgroup = baseline_dealers$training_control)
baseline_dealers$index_ratings_midT <- index_ratings_mid$index
#3.
index_overall_prim_dealer_mid <- icwIndex(xmat=variables_overall_prim_dealer_mid,sgroup = baseline_dealers$training_control)
baseline_dealers$index_overall_prim_dealer_midT <- index_overall_prim_dealer_mid$index
results_dealer_sec_nobase <- c("index_motivation_midT","index_ratings_midT"
,"index_overall_prim_dealer_midT","index_overallsec_midT"
,"index_overall_off_midT")
for (i in 1:length(results_dealer_sec_nobase)){
ols <- lm(as.formula(paste(results_dealer_sec_nobase[i],"training*clearing_demeaned*farmer_demeaned",sep="~")),data=baseline_dealers)
vcov_cluster <- vcovCR(ols,cluster=baseline_dealers$catchID,type="CR0")
df_ols_D_sec_nobase[1,1,i] <- coef_test(ols, vcov_cluster)$beta[2]
df_ols_D_sec_nobase[2,1,i] <- coef_test(ols, vcov_cluster)$SE[2]
df_ols_D_sec_nobase[3,1,i] <- coef_test(ols, vcov_cluster)$p_Satt[2]}
###
#3#
###
baseline_dealers$clearing_control[baseline_dealers$clearing==0] <- TRUE
baseline_dealers$clearing_control[baseline_dealers$clearing==1] <- FALSE
#1.
index_motivation_mid <- icwIndex(xmat=variables_motivation_mid,sgroup = baseline_dealers$clearing_control)
baseline_dealers$index_motivation_midC <- index_motivation_mid$index
#2.
index_ratings_mid <- icwIndex(xmat=variables_ratings_mid,sgroup = baseline_dealers$clearing_control)
baseline_dealers$index_ratings_midC <- index_ratings_mid$index
#3.
index_overall_prim_dealer_mid <- icwIndex(xmat=variables_overall_prim_dealer_mid,sgroup = baseline_dealers$clearing_control)
baseline_dealers$index_overall_prim_dealer_midC <- index_overall_prim_dealer_mid$index
results_dealer_sec_nobase <- c("index_motivation_midC","index_ratings_midC"
,"index_overall_prim_dealer_midC","index_overallsec_midC"
,"index_overall_off_midC")
for (i in 1:length(results_dealer_sec_nobase)){
ols <- lm(as.formula(paste(results_dealer_sec_nobase[i],"training_demeaned*clearing*farmer_demeaned",sep="~")),data=baseline_dealers)
vcov_cluster <- vcovCR(ols,cluster=baseline_dealers$catchID,type="CR0")
df_ols_D_sec_nobase[1,2,i] <- coef_test(ols, vcov_cluster)$beta[3]
df_ols_D_sec_nobase[2,2,i] <- coef_test(ols, vcov_cluster)$SE[3]
df_ols_D_sec_nobase[3,2,i] <- coef_test(ols, vcov_cluster)$p_Satt[3]}
###
#4#
###
baseline_dealers$farmer_control[baseline_dealers$farmer==0] <- TRUE
baseline_dealers$farmer_control[baseline_dealers$farmer==1] <- FALSE
#1.
index_motivation_mid <- icwIndex(xmat=variables_motivation_mid,sgroup = baseline_dealers$farmer_control)
baseline_dealers$index_motivation_midF <- index_motivation_mid$index
#2.
index_ratings_mid <- icwIndex(xmat=variables_ratings_mid,sgroup = baseline_dealers$farmer_control)
baseline_dealers$index_ratings_midF <- index_ratings_mid$index
#3.
index_overall_prim_dealer_mid <- icwIndex(xmat=variables_overall_prim_dealer_mid,sgroup = baseline_dealers$farmer_control)
baseline_dealers$index_overall_prim_dealer_midF <- index_overall_prim_dealer_mid$index
results_dealer_sec_nobase <- c("index_motivation_midF","index_ratings_midF"
,"index_overall_prim_dealer_midF","index_overallsec_midF"
,"index_overall_off_midF")
for (i in 1:length(results_dealer_sec_nobase)){
ols <- lm(as.formula(paste(results_dealer_sec_nobase[i],"training_demeaned*clearing_demeaned*farmer",sep="~")),data=baseline_dealers)
vcov_cluster <- vcovCR(ols,cluster=baseline_dealers$catchID,type="CR0")
#farmer video treatment at village/shop level so no clustering needed
df_ols_D_sec_nobase[1,3,i] <- summary(ols)$coefficients[4,1]
df_ols_D_sec_nobase[2,3,i] <- summary(ols)$coefficients[4,2]
df_ols_D_sec_nobase[3,3,i] <- summary(ols)$coefficients[4,4]}
################################################################################################################################################################################
##### 8 ANALYSIS: Farmer - Primary##############################################################################################################################################
################################################################################################################################################################################
#Heterogeneity analyses
#2: Larger catchment areas
baseline_farmers$small_catchID <- ifelse(baseline_farmers$catchID==16|baseline_farmers$catchID==18|baseline_farmers$catchID==19|
baseline_farmers$catchID==33|baseline_farmers$catchID==34|baseline_farmers$catchID==36|
baseline_farmers$catchID==42|baseline_farmers$catchID==45|baseline_farmers$catchID==46|
baseline_farmers$catchID==48|baseline_farmers$catchID==53|baseline_farmers$catchID==63|
baseline_farmers$catchID==65|baseline_farmers$catchID==66|baseline_farmers$catchID==67|
baseline_farmers$catchID==73|baseline_farmers$catchID==79|baseline_farmers$catchID==80|
baseline_farmers$catchID==87|baseline_farmers$catchID==89|baseline_farmers$catchID==90|
baseline_farmers$catchID==91|baseline_farmers$catchID==92|baseline_farmers$catchID==93|
baseline_farmers$catchID==95|baseline_farmers$catchID==98|baseline_farmers$catchID==101|
baseline_farmers$catchID==103|baseline_farmers$catchID==106|baseline_farmers$catchID==107|
baseline_farmers$catchID==108|baseline_farmers$catchID==109|baseline_farmers$catchID==110|
baseline_farmers$catchID==112|baseline_farmers$catchID==116|baseline_farmers$catchID==118|
baseline_farmers$catchID==120|baseline_farmers$catchID==121|baseline_farmers$catchID==122|
baseline_farmers$catchID==124|baseline_farmers$catchID==125|baseline_farmers$catchID==126|
baseline_farmers$catchID==127|baseline_farmers$catchID==128|baseline_farmers$catchID==129|
baseline_farmers$catchID==130,1,0)
#baseline_farmers=subset(baseline_farmers,small_catchID=="0")
#3: Less competitive catchment areas
baseline_farmers$large_catchID <- ifelse(baseline_farmers$catchID==3|baseline_farmers$catchID==32|baseline_farmers$catchID==59,1,0)
# |baseline_farmers$catchID==64
#baseline_farmers=subset(baseline_farmers,large_catchID=="0")
baseline_farmers=subset(baseline_farmers,Check2.check.maize.q25a=="0")
baseline_farmers[baseline_farmers==999] <- NA
#baseline_farmers[baseline_farmers==96] <- NA
baseline_farmers[, 4:270][baseline_farmers[, 4:270] == 96] <- NA #columns 4-246 only
#baseline_farmers[baseline_farmers==98] <- NA
baseline_farmers[, 4:270][baseline_farmers[, 4:270] == 98] <- NA
baseline_farmers[baseline_farmers=="n/a"] <- NA
#1. Q25a. Did you use any quality maize seed like **OPV or hybrid in **seed  the second season of **2020 (entoigo 2020)** for any of your plots?
baseline_farmers$mid_Check2.check.maize.q25a <- baseline_farmers$check.maize.q25a
baseline_farmers$mid_Check2.check.maize.q25a<-ifelse(baseline_farmers$mid_Check2.check.maize.q25a=="Yes",1,0)
#2. q25b. Where did you obtain the maize seed used in the second season of **2020 (entoigo 2020)** on any of your plots?
baseline_farmers$agro <- ifelse(baseline_farmers$Check2.check.maize.q25b=="d",1,0)
baseline_farmers$agro[is.na(baseline_farmers$Check2.check.maize.q25b)] <- NA
baseline_farmers$agro[baseline_farmers$Check2.check.maize.q25a==0] = 0
baseline_farmers$mid_agro <- ifelse(baseline_farmers$check.maize.q25b=="d",1,0)
baseline_farmers$mid_agro[is.na(baseline_farmers$check.maize.q25b)] <- NA
baseline_farmers$mid_agro[baseline_farmers$check.maize.q25a=="No"] = 0
#3. Q25d. How much quality maize seed (hybrid or OPV) did you buy from an input dealer in the second agricultural season of 2020? Record amount in **KG**
#baseline_farmers$Check2.check.maize.q25d[baseline_farmers$agro==0] = 0
baseline_farmers$Check2.check.maize.q25d <- ihs(baseline_farmers$Check2.check.maize.q25d)
baseline_farmers <- trim("Check2.check.maize.q25d",baseline_farmers,trim_perc=.05)
baseline_farmers$Check2.check.maize.q25d <- 0
#email to Bjorn (08/04) about farmer q25d
baseline_farmers$mid_Check2.check.maize.q25d <- baseline_farmers$check.maize.q25d
baseline_farmers$mid_Check2.check.maize.q25d <- as.numeric((as.character(baseline_farmers$mid_Check2.check.maize.q25d)))
#baseline_farmers$mid_Check2.check.maize.q25d[baseline_farmers$mid_agro==0] = 0
baseline_farmers$mid_Check2.check.maize.q25d <- ihs(baseline_farmers$mid_Check2.check.maize.q25d)
baseline_farmers <- trim("mid_Check2.check.maize.q25d",baseline_farmers,trim_perc=.05)
#4. services
variables_servicesF_mid <- cbind(baseline_farmers$mid_refunds,baseline_farmers$mid_gives_credit,baseline_farmers$mid_gives_advice
,baseline_farmers$mid_delivers,baseline_farmers$mid_after_sales_service,baseline_farmers$mid_payment_mehtods
,baseline_farmers$mid_small_quant)
variables_servicesF_base <- cbind(baseline_farmers$refunds,baseline_farmers$gives_credit,baseline_farmers$gives_advice
,baseline_farmers$delivers,baseline_farmers$after_sales_service,baseline_farmers$payment_mehtods
,baseline_farmers$small_quant)
index_servicesF_mid <- icwIndex(xmat=variables_servicesF_mid)
baseline_farmers$index_servicesF_mid <- index_servicesF_mid$index
index_servicesF_base <- icwIndex(xmat=variables_servicesF_base)
baseline_farmers$index_servicesF_base <- index_servicesF_base$index
#5. practices
#q40 (Wilber: For q40, options b and c are technically correct. b if 2 seeds per hill are used and c if 1 seed per hill is used.)
baseline_farmers$correct_q40 <- 0
baseline_farmers$correct_q40[baseline_farmers$Check2.check.maize.q40=="b"] <- 1
baseline_farmers$correct_q40[baseline_farmers$Check2.check.maize.q40=="c"] <- 1
baseline_farmers$mid_Check2.check.maize.q40 <- baseline_farmers$check.maize.q40
baseline_farmers$mid_correct_q40 <- 0
baseline_farmers$mid_correct_q40[baseline_farmers$mid_Check2.check.maize.q40=="b"] <- 1
baseline_farmers$mid_correct_q40[baseline_farmers$mid_Check2.check.maize.q40=="c"] <- 1
#q41 (Wilber: The same applies to q41.)
baseline_farmers$correct_q41 <- ifelse(baseline_farmers$Check2.check.maize.q41=="1",1,0)
baseline_farmers$correct_q41[baseline_farmers$Check2.check.maize.q41=="2"] <- 1
baseline_farmers$mid_Check2.check.maize.q41 <- baseline_farmers$check.maize.q41
baseline_farmers$mid_Check2.check.maize.q41 <- as.numeric(as.character(baseline_farmers$mid_Check2.check.maize.q41))
baseline_farmers$mid_correct_q41 <- ifelse(baseline_farmers$mid_Check2.check.maize.q41=="1",1,0)
baseline_farmers$mid_correct_q41[baseline_farmers$mid_Check2.check.maize.q41=="2"] <- 1
#q42
baseline_farmers$correct_q42 <- NA
baseline_farmers$correct_q42[baseline_farmers$Check2.check.maize.q42=="1"] <- 1
baseline_farmers$correct_q42[baseline_farmers$Check2.check.maize.q42=="0"] <- 0
baseline_farmers$mid_Check2.check.maize.q42 <- baseline_farmers$check.maize.q42
baseline_farmers$mid_Check2.check.maize.q42<-ifelse(baseline_farmers$mid_Check2.check.maize.q42=="Yes",1,0)
baseline_farmers$mid_correct_q42 <- NA
baseline_farmers$mid_correct_q42[baseline_farmers$mid_Check2.check.maize.q42=="1"] <- 1
baseline_farmers$mid_correct_q42[baseline_farmers$mid_Check2.check.maize.q42=="0"] <- 0
#q43
baseline_farmers$correct_q43 <- NA
baseline_farmers$correct_q43[baseline_farmers$Check2.check.maize.q43=="1"] <- 1
baseline_farmers$correct_q43[baseline_farmers$Check2.check.maize.q43=="0"] <- 0
baseline_farmers$mid_Check2.check.maize.q43 <- baseline_farmers$check.maize.q43
baseline_farmers$mid_Check2.check.maize.q43<-ifelse(baseline_farmers$mid_Check2.check.maize.q43=="Yes",1,0)
baseline_farmers$mid_correct_q43 <- NA
baseline_farmers$mid_correct_q43[baseline_farmers$mid_Check2.check.maize.q43=="1"] <- 1
baseline_farmers$mid_correct_q43[baseline_farmers$mid_Check2.check.maize.q43=="0"] <- 0
#q44
baseline_farmers$correct_q44 <- NA
baseline_farmers$correct_q44[baseline_farmers$Check2.check.maize.q44=="1"] <- 1
baseline_farmers$correct_q44[baseline_farmers$Check2.check.maize.q44=="0"] <- 0
baseline_farmers$mid_Check2.check.maize.q44 <- baseline_farmers$check.maize.q44
baseline_farmers$mid_Check2.check.maize.q44<-ifelse(baseline_farmers$mid_Check2.check.maize.q44=="Yes",1,0)
baseline_farmers$mid_Check2.check.maize.q44 <- as.numeric(as.character(baseline_farmers$mid_Check2.check.maize.q44))
baseline_farmers$mid_correct_q44 <- NA
baseline_farmers$mid_correct_q44[baseline_farmers$mid_Check2.check.maize.q44=="1"] <- 1
baseline_farmers$mid_correct_q44[baseline_farmers$mid_Check2.check.maize.q44=="0"] <- 0
#q45
baseline_farmers$correct_q45[baseline_farmers$Check2.check.maize.q45>=3] <- 1
baseline_farmers$correct_q45[baseline_farmers$Check2.check.maize.q45<3] <- 0
baseline_farmers$mid_Check2.check.maize.q45 <- baseline_farmers$check.maize.q45
baseline_farmers$mid_Check2.check.maize.q45 <- as.numeric(as.character(baseline_farmers$mid_Check2.check.maize.q45))
baseline_farmers$mid_correct_q45[baseline_farmers$mid_Check2.check.maize.q45>=3] <- 1
baseline_farmers$mid_correct_q45[baseline_farmers$mid_Check2.check.maize.q45<3] <- 0
#q46
baseline_farmers$correct_q46 <- (baseline_farmers$Check2.check.maize.q46 <= 20)
baseline_farmers$correct_q46<-ifelse(baseline_farmers$correct_q46=="TRUE",1,0)
baseline_farmers$mid_Check2.check.maize.q46 <- baseline_farmers$check.maize.q46
baseline_farmers$mid_Check2.check.maize.q46 <- (as.numeric(as.character(baseline_farmers$mid_Check2.check.maize.q46)))
baseline_farmers$mid_correct_q46 <- (baseline_farmers$mid_Check2.check.maize.q46 <= 20)
baseline_farmers$mid_correct_q46<-ifelse(baseline_farmers$mid_correct_q46=="TRUE",1,0)
#q47
baseline_farmers$correct_q47 <- NA
baseline_farmers$correct_q47[baseline_farmers$Check2.check.maize.q47=="1"] <- 1
baseline_farmers$correct_q47[baseline_farmers$Check2.check.maize.q47=="0"] <- 0
baseline_farmers$mid_Check2.check.maize.q47 <- baseline_farmers$check.maize.q47
baseline_farmers$mid_Check2.check.maize.q47<-ifelse(baseline_farmers$mid_Check2.check.maize.q47=="Yes",1,0)
baseline_farmers$mid_correct_q47 <- NA
baseline_farmers$mid_correct_q47[baseline_farmers$mid_Check2.check.maize.q47=="1"] <- 1
baseline_farmers$mid_correct_q47[baseline_farmers$mid_Check2.check.maize.q47=="0"] <- 0
#q48
baseline_farmers$correct_q48 <- ifelse(baseline_farmers$Check2.check.maize.q48=="2",1,0)
baseline_farmers$correct_q48[is.na(baseline_farmers$Check2.check.maize.q48)] <- NA
baseline_farmers$mid_Check2.check.maize.q48 <- baseline_farmers$check.maize.q48
baseline_farmers$mid_correct_q48 <- ifelse(baseline_farmers$mid_Check2.check.maize.q48=="2",1,0)
baseline_farmers$mid_correct_q48[is.na(baseline_farmers$mid_Check2.check.maize.q48)] <- NA
#q49
baseline_farmers$correct_q49 <- NA
baseline_farmers$correct_q49[baseline_farmers$Check2.check.maize.q49=="1"] <- 1
baseline_farmers$correct_q49[baseline_farmers$Check2.check.maize.q49=="0"] <- 0
baseline_farmers$mid_Check2.check.maize.q49 <- baseline_farmers$check.maize.q49
baseline_farmers$mid_Check2.check.maize.q49<-ifelse(baseline_farmers$mid_Check2.check.maize.q49=="Yes",1,0)
baseline_farmers$mid_correct_q49 <- NA
baseline_farmers$mid_correct_q49[baseline_farmers$mid_Check2.check.maize.q49=="1"] <- 1
baseline_farmers$mid_correct_q49[baseline_farmers$mid_Check2.check.maize.q49=="0"] <- 0
variables_practices_mid <- cbind(baseline_farmers$mid_correct_q40,baseline_farmers$mid_correct_q41,baseline_farmers$mid_correct_q42
,baseline_farmers$mid_correct_q43,baseline_farmers$mid_correct_q44,baseline_farmers$mid_correct_q45
,baseline_farmers$mid_correct_q46,baseline_farmers$mid_correct_q47,baseline_farmers$mid_correct_q48
,baseline_farmers$mid_correct_q49)
variables_practices_base <- cbind(baseline_farmers$correct_q40,baseline_farmers$correct_q41,baseline_farmers$correct_q42
,baseline_farmers$correct_q43,baseline_farmers$correct_q44,baseline_farmers$correct_q45
,baseline_farmers$correct_q46,baseline_farmers$correct_q47,baseline_farmers$correct_q48
,baseline_farmers$correct_q49)
index_practices_mid <- icwIndex(xmat=variables_practices_mid)
baseline_farmers$index_practices_mid <- index_practices_mid$index
index_practices_base <- icwIndex(xmat=variables_practices_base)
baseline_farmers$index_practices_base <- index_practices_base$index
#Q25h. Do you think that maize seed that you can buy at agro-input dealer is counterfeit/adulterated? NEW ANSWER OPTION
baseline_farmers$mid_Check2.check.maize.q25h <- baseline_farmers$check.maize.q25h
baseline_farmers$mid_Check2.check.maize.q25h<-ifelse(baseline_farmers$mid_Check2.check.maize.q25h=="Yes",1,0)
#farmer saved
baseline_farmers$mid_Check2.check.maize.q31 <- baseline_farmers$check.maize.q31
baseline_farmers$mid_Land_Races<-ifelse(baseline_farmers$mid_Check2.check.maize.q31=="Land_Races",1,0)
#6. overall index
variables_overallprimF_mid <- cbind(
baseline_farmers$index_practices_mid
,baseline_farmers$mid_Check2.check.maize.q25h,baseline_farmers$mid_Land_Races)
variables_overallprimF_base <- cbind(
baseline_farmers$index_practices_base
,baseline_farmers$Check2.check.maize.q25h,baseline_farmers$Land_Races)
index_overallprimF_mid <- icwIndex(xmat=variables_overallprimF_mid,revcols = c(2,3))
baseline_farmers$index_overallprimF_mid <- index_overallprimF_mid$index
index_overallprimF_base <- icwIndex(xmat=variables_overallprimF_base,revcols = c(2,3))
baseline_farmers$index_overallprimF_base <- index_overallprimF_base$index
################################################################################################################################################################################
###
#1#
###
results_farmer_prim <- c("mid_Check2.check.maize.q25a","mid_agro","mid_Check2.check.maize.q25d"
,"index_servicesF_mid","index_practices_mid","mid_Check2.check.maize.q25h"
,"mid_Land_Races","index_overallprimF_mid")
results_farmer_prim_base <- c("Check2.check.maize.q25a","agro","Check2.check.maize.q25d"
,"index_servicesF_base","index_practices_base","Check2.check.maize.q25h"
,"Land_Races","index_overallprimF_base")
baseline_farmers[results_farmer_prim_base] <- lapply(baseline_farmers[results_farmer_prim_base],function(x)x - mean(x,na.rm = T))
df_means_F_prim <- array(NA,dim=c(3,8))
for (i in 1:length(results_farmer_prim)){
df_means_F_prim[1,i] <- sum(baseline_farmers[results_farmer_prim[i]], na.rm=T)/(nrow(baseline_farmers)-sum(is.na(baseline_farmers[results_farmer_prim[i]])))
df_means_F_prim[2,i] <- sqrt(var(baseline_farmers[results_farmer_prim[i]], na.rm=T))
df_means_F_prim[3,i] <- nrow(baseline_farmers)-sum(is.na(baseline_farmers[results_farmer_prim[i]]))-sum(is.na(baseline_farmers[results_farmer_prim_base[i]]))+sum(is.na(baseline_farmers[results_farmer_prim[i]])&is.na(baseline_farmers[results_farmer_prim_base[i]]))}
###
#2#
###
baseline_farmers$training_control[baseline_farmers$training==0] <- TRUE
baseline_farmers$training_control[baseline_farmers$training==1] <- FALSE
#4.
index_servicesF_midT <- icwIndex(xmat=variables_servicesF_mid,sgroup = baseline_farmers$training_control)
baseline_farmers$index_servicesF_midT <- index_servicesF_midT$index
index_servicesF_baseT <- icwIndex(xmat=variables_servicesF_base,sgroup = baseline_farmers$training_control)
baseline_farmers$index_servicesF_baseT <- index_servicesF_baseT$index
#5.
index_practices_midT <- icwIndex(xmat=variables_practices_mid,sgroup = baseline_farmers$training_control)
baseline_farmers$index_practices_midT <- index_practices_midT$index
index_practices_baseT <- icwIndex(xmat=variables_practices_base,sgroup = baseline_farmers$training_control)
baseline_farmers$index_practices_baseT <- index_practices_baseT$index
#6.
index_overallprimF_midT <- icwIndex(xmat=variables_overallprimF_mid,sgroup = baseline_farmers$training_control,revcols = c(2,3))
baseline_farmers$index_overallprimF_midT <- index_overallprimF_midT$index
index_overallprimF_baseT <- icwIndex(xmat=variables_overallprimF_base,sgroup = baseline_farmers$training_control,revcols = c(2,3))
baseline_farmers$index_overallprimF_baseT <- index_overallprimF_baseT$index
df_ols_F_prim <- array(NA,dim=c(3,3,11))
results_farmer_prim <- c("mid_Check2.check.maize.q25a","mid_agro","mid_Check2.check.maize.q25d"
,"index_servicesF_midT","index_practices_midT","mid_Check2.check.maize.q25h"
,"mid_Land_Races","index_overallprimF_midT")
results_farmer_prim_base <- c("Check2.check.maize.q25a","agro","Check2.check.maize.q25d"
,"index_servicesF_baseT","index_practices_baseT","Check2.check.maize.q25h"
,"Land_Races","index_overallprimF_baseT")
baseline_farmers[results_farmer_prim_base] <- lapply(baseline_farmers[results_farmer_prim_base],function(x)x - mean(x,na.rm = T))
baseline_farmers$training_demeaned <- baseline_farmers$training - mean(baseline_farmers$training,na.rm = T)
baseline_farmers$clearing_demeaned <- baseline_farmers$clearing - mean(baseline_farmers$clearing,na.rm = T)
baseline_farmers$farmer_demeaned <- baseline_farmers$farmer - mean(baseline_farmers$farmer,na.rm = T)
for (i in 1:length(results_farmer_prim)){
ols <- lm(as.formula(paste(paste(results_farmer_prim[i],"training*clearing_demeaned*farmer_demeaned",sep="~"),results_farmer_prim_base[i],sep="+")),data=baseline_farmers)
#ols <- lm(as.formula(paste(results_farmer_prim[i],"training*clearing_demeaned*farmer_demeaned",sep="~")),data=baseline_farmers)
vcov_cluster <- vcovCR(ols,cluster=baseline_farmers$catchID,type="CR0")
df_ols_F_prim[1,1,i] <- coef_test(ols, vcov_cluster)$beta[2]
df_ols_F_prim[2,1,i] <- coef_test(ols, vcov_cluster)$SE[2]
df_ols_F_prim[3,1,i] <- coef_test(ols, vcov_cluster)$p_Satt[2]}
###
#3#
###
baseline_farmers$clearing_control[baseline_farmers$clearing==0] <- TRUE
baseline_farmers$clearing_control[baseline_farmers$clearing==1] <- FALSE
#4.
index_servicesF_midC <- icwIndex(xmat=variables_servicesF_mid,sgroup = baseline_farmers$clearing_control)
baseline_farmers$index_servicesF_midC <- index_servicesF_midC$index
index_servicesF_baseC <- icwIndex(xmat=variables_servicesF_base,sgroup = baseline_farmers$clearing_control)
baseline_farmers$index_servicesF_baseC <- index_servicesF_baseC$index
#5.
index_practices_midC <- icwIndex(xmat=variables_practices_mid,sgroup = baseline_farmers$clearing_control)
baseline_farmers$index_practices_midC <- index_practices_midC$index
index_practices_baseC <- icwIndex(xmat=variables_practices_base,sgroup = baseline_farmers$clearing_control)
baseline_farmers$index_practices_baseC <- index_practices_baseC$index
#6.
index_overallprimF_midC <- icwIndex(xmat=variables_overallprimF_mid,sgroup = baseline_farmers$clearing_control,revcols = c(2,3))
baseline_farmers$index_overallprimF_midC <- index_overallprimF_midC$index
index_overallprimF_baseC <- icwIndex(xmat=variables_overallprimF_base,sgroup = baseline_farmers$clearing_control,revcols = c(2,3))
baseline_farmers$index_overallprimF_baseC <- index_overallprimF_baseC$index
results_farmer_prim <- c("mid_Check2.check.maize.q25a","mid_agro","mid_Check2.check.maize.q25d"
,"index_servicesF_midC","index_practices_midC","mid_Check2.check.maize.q25h"
,"mid_Land_Races","index_overallprimF_midC")
results_farmer_prim_base <- c("Check2.check.maize.q25a","agro","Check2.check.maize.q25d"
,"index_servicesF_baseC","index_practices_baseC","Check2.check.maize.q25h"
,"Land_Races","index_overallprimF_baseC")
baseline_farmers[results_farmer_prim_base] <- lapply(baseline_farmers[results_farmer_prim_base],function(x)x - mean(x,na.rm = T))
for (i in 1:length(results_farmer_prim)){
ols <- lm(as.formula(paste(paste(results_farmer_prim[i],"training_demeaned*clearing*farmer_demeaned",sep="~"),results_farmer_prim_base[i],sep="+")),data=baseline_farmers)
#ols <- lm(as.formula(paste(results_farmer_prim[i],"training_demeaned*clearing*farmer_demeaned",sep="~")),data=baseline_farmers)
vcov_cluster <- vcovCR(ols,cluster=baseline_farmers$catchID,type="CR0")
df_ols_F_prim[1,2,i] <- coef_test(ols, vcov_cluster)$beta[3]
df_ols_F_prim[2,2,i] <- coef_test(ols, vcov_cluster)$SE[3]
df_ols_F_prim[3,2,i] <- coef_test(ols, vcov_cluster)$p_Satt[3]}
###
#4#
###
baseline_farmers$farmer_control[baseline_farmers$farmer==0] <- TRUE
baseline_farmers$farmer_control[baseline_farmers$farmer==1] <- FALSE
#4.
index_servicesF_midF <- icwIndex(xmat=variables_servicesF_mid,sgroup = baseline_farmers$farmer_control)
baseline_farmers$index_servicesF_midF <- index_servicesF_midF$index
index_servicesF_baseF <- icwIndex(xmat=variables_servicesF_base,sgroup = baseline_farmers$farmer_control)
baseline_farmers$index_servicesF_baseF <- index_servicesF_baseF$index
#5.
index_practices_midF <- icwIndex(xmat=variables_practices_mid,sgroup = baseline_farmers$farmer_control)
baseline_farmers$index_practices_midF <- index_practices_midF$index
index_practices_baseF <- icwIndex(xmat=variables_practices_base,sgroup = baseline_farmers$farmer_control)
baseline_farmers$index_practices_baseF <- index_practices_baseF$index
#6.
index_overallprimF_midF <- icwIndex(xmat=variables_overallprimF_mid,sgroup = baseline_farmers$farmer_control,revcols = c(2,3))
baseline_farmers$index_overallprimF_midF <- index_overallprimF_midF$index
index_overallprimF_baseF <- icwIndex(xmat=variables_overallprimF_base,sgroup = baseline_farmers$farmer_control,revcols = c(2,3))
baseline_farmers$index_overallprimF_baseF <- index_overallprimF_baseF$index
results_farmer_prim <- c("mid_Check2.check.maize.q25a","mid_agro","mid_Check2.check.maize.q25d"
,"index_servicesF_midF","index_practices_midF","mid_Check2.check.maize.q25h"
,"mid_Land_Races","index_overallprimF_midF")
results_farmer_prim_base <- c("Check2.check.maize.q25a","agro","Check2.check.maize.q25d"
,"index_servicesF_baseF","index_practices_baseF","Check2.check.maize.q25h"
,"Land_Races","index_overallprimF_baseF")
baseline_farmers[results_farmer_prim_base] <- lapply(baseline_farmers[results_farmer_prim_base],function(x)x - mean(x,na.rm = T))
for (i in 1:length(results_farmer_prim)){
ols <- lm(as.formula(paste(paste(results_farmer_prim[i],"training_demeaned*clearing_demeaned*farmer",sep="~"),results_farmer_prim_base[i],sep="+")),data=baseline_farmers)
#ols <- lm(as.formula(paste(results_farmer_prim[i],"training_demeaned*clearing_demeaned*farmer",sep="~")),data=baseline_farmers)
vcov_cluster_shop <- vcovCR(ols,cluster=baseline_farmers$shop_ID,type="CR0")
#farmer video treatment at village/shop level so no clustering needed
df_ols_F_prim[1,3,i] <- coef_test(ols, vcov_cluster_shop)$beta[4]
df_ols_F_prim[2,3,i] <- coef_test(ols, vcov_cluster_shop)$SE[4]
df_ols_F_prim[3,3,i] <- coef_test(ols, vcov_cluster_shop)$p_Satt[4]}
#transformation because otherwise no correlation between agro and q25d possible:
baseline_farmers$Check2.check.maize.q25d_save <- baseline_farmers$Check2.check.maize.q25d
baseline_farmers$mid_Check2.check.maize.q25d_save <- baseline_farmers$mid_Check2.check.maize.q25d
baseline_farmers$Check2.check.maize.q25d[baseline_farmers$agro==0] = 0
baseline_farmers$Check2.check.maize.q25d <- ihs(baseline_farmers$Check2.check.maize.q25d)
baseline_farmers$mid_Check2.check.maize.q25d[baseline_farmers$mid_agro==0] = 0
baseline_farmers$mid_Check2.check.maize.q25d <- ihs(baseline_farmers$mid_Check2.check.maize.q25d)
#Aker, Boumnijel, McClelland, Tierney (2012)
df_farmer_primT <- data.frame(baseline_farmers$mid_Check2.check.maize.q25a,baseline_farmers$mid_agro
,baseline_farmers$mid_Check2.check.maize.q25d,baseline_farmers$index_servicesF_midT
,baseline_farmers$index_practices_midT,baseline_farmers$mid_Check2.check.maize.q25h,baseline_farmers$mid_Land_Races)
df_farmer_primC <- data.frame(baseline_farmers$mid_Check2.check.maize.q25a,baseline_farmers$mid_agro
,baseline_farmers$mid_Check2.check.maize.q25d,baseline_farmers$index_servicesF_midC
,baseline_farmers$index_practices_midC,baseline_farmers$mid_Check2.check.maize.q25h,baseline_farmers$mid_Land_Races)
df_farmer_primF <- data.frame(baseline_farmers$mid_Check2.check.maize.q25a,baseline_farmers$mid_agro
,baseline_farmers$mid_Check2.check.maize.q25d,baseline_farmers$index_servicesF_midF
,baseline_farmers$index_practices_midF,baseline_farmers$mid_Check2.check.maize.q25h,baseline_farmers$mid_Land_Races)
#no overall index
df_ols_F_prim_J <- array(NA,dim=c(3,3,11))
results_farmer_prim_J <- c("mid_Check2.check.maize.q25a","mid_agro","mid_Check2.check.maize.q25d"
,"index_servicesF_mid","index_practices_midF","mid_Check2.check.maize.q25h"
,"mid_Land_Races")
#no overall index
for (i in 1:length(results_farmer_prim_J)){
df_ols_F_prim_J[3,1,i] <- adjust_p(df_ols_F_prim[3,1,i],df_farmer_primT,i)
df_ols_F_prim_J[3,2,i] <- adjust_p(df_ols_F_prim[3,2,i],df_farmer_primC,i)
df_ols_F_prim_J[3,3,i] <- adjust_p(df_ols_F_prim[3,3,i],df_farmer_primF,i)}
baseline_farmers$Check2.check.maize.q25d <- baseline_farmers$Check2.check.maize.q25d_save
baseline_farmers$mid_Check2.check.maize.q25d <- baseline_farmers$mid_Check2.check.maize.q25d_save
setwd("C:/Users/u0127963/Desktop/PhD/Seed_systems_project/papers/clearinghouse_training_paper")
rm(list=ls())
#df_ols_ --> df_ols_end_
#df_means_ --> df_means_end_
path <- getwd()
#path <- strsplit(path,"/papers/endline_report")[[1]]
path <- strsplit(path,"/papers/clearinghouse_training_paper")[[1]]
baseline_dealers <- read.csv(paste(path,"/baseline/data/agro_input/public/baseline_dealer.csv",sep="/"), stringsAsFactors=TRUE)
baseline_farmers <- read.csv(paste(path,"/baseline/data/farmer/public/baseline_farmers.csv",sep="/"), stringsAsFactors=TRUE)
midline_farmers <- read.csv(paste(path,"/midline/data/farmer/public/midline.csv",sep="/"), stringsAsFactors=TRUE)
endline_farmers <- read.csv(paste(path,"/endline/data/farmer/public/endline.csv",sep="/"), stringsAsFactors=TRUE)
